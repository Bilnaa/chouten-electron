<!DOCTYPE html>
<html>
<head>
  <title>Hidden Scraper</title>
</head>
<body>
  <webview src="about:blank" style="width:100%; height:100%;"></webview>
</body>
<script>
class Response {
    constructor(statusCode, body, contentType, headers) {
        this.statusCode = statusCode;
        this.body = body;
        this.contentType = contentType;
        this.headers = headers || {};
    }

    json() {
        return JSON.parse(this.body);
    }
}
</script>
<script>
  async function request(url, method, headers = {}, body = null) {
    const fetchResp = await fetch(url, {
        method,
        headers,
        body
    });

    const responseHeaders = {};
    fetchResp.headers.forEach((value, key) => {
        responseHeaders[key] = value;
    });

    return new Response(
        fetchResp.status,
        await fetchResp.text(),
        fetchResp.headers.get("content-type") || '',
        responseHeaders
    );
};

async function callWebview(url) {
    const webview = document.querySelector('webview');
    webview.src = url;
    await new Promise(resolve => {
        webview.addEventListener('did-stop-loading', resolve);
    });
    const content = await webview.executeJavaScript('document.documentElement.outerHTML');
    return new Response(
        200,
        content,
        'text/html',
        {}
    );
}
</script>
</html>